<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Quản lý Hộ khẩu</title>
    <link rel="stylesheet" href="assets/css/layout.css" />
    <link rel="stylesheet" href="assets/css/style.css" />
    <link rel="stylesheet" href="assets/css/households.css" />
  </head>
  <body>
    <div id="navbar"></div>
    <main class="dashboard">
      <aside id="sidebar"></aside>
      <section class="content">
        <h2>Quản lý Hộ khẩu</h2>

        <div class="content-header">
          <div class="search-bar">
            <input id="search-input" type="text" placeholder="Tìm theo tên chủ hộ hoặc số hộ khẩu..." />
            <button id="search-btn" class="btn">Tìm kiếm</button>
            <button id="clear-search-btn" class="btn btn-secondary">Xóa tìm kiếm</button>
          </div>
          <button id="add-household-btn" class="btn btn-primary">+ Thêm hộ khẩu</button>
        </div>

        <div class="table-container">
          <table class="data-table">
            <thead>
              <tr>
                <th>STT</th>
                <th>Số hộ khẩu</th>
                <th>Tên chủ hộ</th>
                <th>Địa chỉ</th>
                <th>Hành động</th>
              </tr>
            </thead>
            <tbody id="household-table-body">
              <tr><td colspan="5">Đang tải dữ liệu...</td></tr>
            </tbody>
          </table>
        </div>

        <div id="pagination-controls" class="pagination"></div>
      </section>
    </main>

    <!-- Modal thêm / sửa hộ khẩu -->
    <div id="household-modal" class="modal-overlay hidden">
      <div class="modal-content">
        <span class="close-btn" data-modal="household-modal">&times;</span>
        <h3 id="modal-title">Thêm hộ khẩu</h3>
        <form id="household-form">
          <input type="hidden" id="soHoKhau" />
          <div class="form-group">
            <label for="maNhanKhauChuHo">Mã nhân khẩu chủ hộ <span class="required">*</span></label>
            <input type="number" id="maNhanKhauChuHo" required />
            <small class="form-hint">Nhập mã nhân khẩu của người làm chủ hộ</small>
          </div>
          <div class="form-group">
            <label for="diaChi">Địa chỉ <span class="required">*</span></label>
            <input type="text" id="diaChi" required />
          </div>
          <div class="form-group">
            <label for="hoSoSo">Hồ sơ số <span class="required">*</span></label>
            <input type="number" id="hoSoSo" required />
          </div>
          <div class="form-group">
            <label for="soDangKySo">Sổ đăng ký số <span class="required">*</span></label>
            <input type="number" id="soDangKySo" required />
          </div>
          <div class="form-group">
            <label for="toSo">Tổ số <span class="required">*</span></label>
            <input type="number" id="toSo" required />
          </div>
          <div class="form-actions">
            <button type="submit" class="btn btn-primary">Lưu</button>
            <button type="button" class="btn btn-secondary close-btn" data-modal="household-modal">Hủy</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Modal chi tiết hộ khẩu -->
    <div id="detail-modal" class="modal-overlay hidden">
      <div class="modal-content large">
        <span class="close-btn" data-modal="detail-modal">&times;</span>
        <h3>Chi tiết Hộ khẩu</h3>
        <div id="detail-content"></div>
      </div>
    </div>

    <!-- Modal xác nhận xóa -->
    <div id="delete-modal" class="modal-overlay hidden">
      <div class="modal-content">
        <span class="close-btn" data-modal="delete-modal">&times;</span>
        <h3>Xác nhận xóa</h3>
        <p>Bạn có chắc chắn muốn xóa hộ khẩu này không?</p>
        <p class="warning-text">⚠️ Lưu ý: Thao tác này sẽ đặt SOHOKHAU của tất cả nhân khẩu trong hộ về NULL.</p>
        <div class="form-actions">
          <button id="confirm-delete-btn" class="btn btn-danger">Xóa</button>
          <button type="button" class="btn btn-secondary close-btn" data-modal="delete-modal">Hủy</button>
        </div>
      </div>
    </div>

    <!-- Modal tách hộ khẩu -->
    <div id="split-modal" class="modal-overlay hidden">
      <div class="modal-content large">
        <span class="close-btn" data-modal="split-modal">&times;</span>
        <h3>Tách hộ khẩu</h3>
        <form id="split-form">
          <input type="hidden" id="split-soHoKhauGoc" />
          
          <h4>Thông tin hộ khẩu mới</h4>
          <div class="form-group">
            <label for="split-maChuHoMoi">Mã nhân khẩu chủ hộ mới <span class="required">*</span></label>
            <input type="number" id="split-maChuHoMoi" required />
          </div>
          <div class="form-group">
            <label for="split-diaChi">Địa chỉ mới <span class="required">*</span></label>
            <input type="text" id="split-diaChi" required />
          </div>
          <div class="form-group">
            <label for="split-hoSoSo">Hồ sơ số <span class="required">*</span></label>
            <input type="number" id="split-hoSoSo" required />
          </div>
          <div class="form-group">
            <label for="split-soDangKySo">Sổ đăng ký số <span class="required">*</span></label>
            <input type="number" id="split-soDangKySo" required />
          </div>
          <div class="form-group">
            <label for="split-toSo">Tổ số <span class="required">*</span></label>
            <input type="number" id="split-toSo" required />
          </div>

          <h4>Chọn thành viên chuyển sang hộ khẩu mới</h4>
          <div id="split-members-list" class="members-checklist">
            <!-- Danh sách checkbox sẽ được render ở đây -->
          </div>

          <div class="form-actions">
            <button type="submit" class="btn btn-primary">Tách hộ</button>
            <button type="button" class="btn btn-secondary close-btn" data-modal="split-modal">Hủy</button>
          </div>
        </form>
      </div>
    </div>

    <script src="assets/js/layout.js"></script>
    <script src="assets/js/households.js"></script>
  </body>
</html>